(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2799:(e,t,s)=>{Promise.resolve().then(s.bind(s,8943))},8943:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var r=s(5155),a=s(2115),l=s(5125);let i=async function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;try{return await axios({url:e,method:t,data:s,timeout:3e4})}catch(l){if(r>0)return console.log("Request failed, retrying... (".concat(r," attempts left)")),await new Promise(e=>setTimeout(e,a)),i(e,t,s,r-1,1.5*a);throw l}};function o(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)([]),[o,n]=(0,a.useState)([]),[c,d]=(0,a.useState)(80),[m,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[u,g]=(0,a.useState)({}),[v,f]=(0,a.useState)("image"),[b,j]=(0,a.useState)({bitrate:"2M",resolution:"720",framerate:"30",codec:"h264"}),[w,y]=(0,a.useState)(!1),N=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?y(!0):"dragleave"===e.type&&y(!1)},k=e=>{t(t=>[...t,...e]),i(t=>[...t,...e.map(e=>URL.createObjectURL(e))]),e.length>0&&f("video"===e[0].type.split("/")[0]?"video":"image")},C=()=>window.isElectron?"http://localhost:4000/api":"/api",S=async function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;try{return await (0,l.A)({url:e,method:t,data:s,timeout:3e4})}catch(l){if(r>0)return console.log("Request failed, retrying... (".concat(r," attempts left)")),await new Promise(e=>setTimeout(e,a)),S(e,t,s,r-1,1.5*a);throw l}},z=async e=>{let t=e.name.replace(/[^\w\d.-]/g,"_"),s=new FormData,r=new File([e],t,{type:e.type});s.append("files",r),t!==e.name&&console.warn('Filename "'.concat(e.name,'" contains special characters that may cause issues. Using "').concat(t,'" instead.'));let a="",i=C();e.type.startsWith("image")?(a="".concat(i,"/compress/image"),s.append("quality",String(c)),s.append("lossless",String(m))):(a="".concat(i,"/compress/video"),s.append("bitrate",b.bitrate),s.append("resolution",b.resolution),s.append("framerate",b.framerate),s.append("codec",b.codec));try{try{await l.A.get("".concat(i,"/health"))}catch(e){try{await l.A.get("".concat(i.replace(/\/$/,""),"/health"))}catch(t){throw console.error("Backend server not available:",e),Error("Backend server not responding. Please make sure it is running on port 4000.")}}if(e.type.startsWith("video/")){if(e.size>524288e3)throw Error("Video file is too large (max 500MB)");/[\s&$#@!()\[\]{}%^*]/.test(e.name)&&console.warn("Video filename contains special characters which may cause issues:",e.name),[".mov",".avi",".wmv",".flv"].some(t=>e.name.toLowerCase().endsWith(t))&&console.warn("The video format ".concat(e.name.split(".").pop()," might have compatibility issues. Consider using MP4 instead."))}let t=await l.A.post(a,s,{onUploadProgress:t=>{console.log("Upload Progress for ".concat(e.name,": ").concat(Math.round(100*t.loaded/(t.total||1)),"%"))},timeout:3e5,headers:{"X-Original-Filename":encodeURIComponent(e.name)}});if(t.data.results&&t.data.results.length>0){let e=t.data.results[0];n(t=>[...t,e])}else throw Error("Server response did not include compression results");g(t=>{let s={...t};return delete s[e.name],s})}catch(r){console.error("Error compressing ".concat(e.name,":"),r);let t="Unknown server error";if(r instanceof Error)t=r.message;else if(l.A.isAxiosError(r)){var o,d;(null==(d=r.response)||null==(o=d.data)?void 0:o.error)?(t=r.response.data.error,r.response.data.details):r.message&&(t=r.message),t.includes("FFmpeg failed")&&(t="Video compression failed. The file may be corrupted or in an unsupported format.")}let s="Failed to compress ".concat(e.name,": ").concat(t);n(t=>[...t,{originalName:e.name,outputName:"Compression failed",originalSize:e.size,compressedSize:0,outputPath:"",error:s}]),g(t=>{let s={...t};return delete s[e.name],s})}},M=async()=>{p(!0);try{let e=C();await l.A.get("".concat(e,"/health"))}catch(e){p(!1),alert("Backend server not responding. Please make sure it is running on port 4000.");return}let t={...u};e.forEach(e=>{t[e.name]=!0}),g(t);let s=0,r=0;try{for(let t of e)try{await z(t),s++}catch(e){console.error("Error compressing ".concat(t.name,":"),e),r++,g(e=>{let s={...e};return delete s[t.name],s})}s>0&&0===r?alert("Successfully compressed ".concat(s," file").concat(1!==s?"s":"")):s>0&&r>0?alert("Compressed ".concat(s," file").concat(1!==s?"s":"",", but ").concat(r," file").concat(1!==r?"s":""," failed. Check the results for details.")):0===s&&r>0&&alert("Failed to compress ".concat(r," file").concat(1!==r?"s":"",". Check the results for details."))}catch(e){console.error("Batch compression error:",e),alert("An unexpected error occurred during compression.")}finally{p(!1)}},L=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",B=async()=>{try{let e=o.map(e=>e.outputPath),t=C();t.replace("/api","");let s=await S("".concat(t,"/download/zip"),"post",{files:e},3,1500),r=new Blob([s.data],{type:"application/zip"}),a=window.URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.setAttribute("download","compressed_media.zip"),document.body.appendChild(l),l.click(),setTimeout(()=>{window.URL.revokeObjectURL(a),l.remove()},100)}catch(e){console.error("Error downloading ZIP file:",e),alert("Failed to download ZIP file. Please try again or download files individually.")}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2 text-gray-800",children:"Media Compressor"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6 text-center max-w-lg",children:"Optimize images and videos with WebP conversion and advanced compression"}),(0,r.jsx)("div",{className:"w-full max-w-6xl bg-white shadow border border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,r.jsx)("div",{className:"lg:w-1/3 p-6 ".concat(w?"bg-blue-50":""),onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:e=>{e.preventDefault(),e.stopPropagation(),y(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&k(Array.from(e.dataTransfer.files))},children:(0,r.jsxs)("div",{className:"sticky top-6",children:[(0,r.jsxs)("div",{className:"mb-6 text-center",children:[(0,r.jsx)("div",{className:"mb-4 flex justify-center",children:(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-50 flex items-center justify-center",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})})}),(0,r.jsx)("h2",{className:"text-lg font-medium mb-2 text-gray-700",children:"Drop files here"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mb-4",children:["Images (JPEG, PNG, GIF)",(0,r.jsx)("br",{}),"Videos (MP4, MOV)"]}),(0,r.jsxs)("label",{className:"cursor-pointer",children:[(0,r.jsx)("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:e=>{let t=Array.from(e.target.files||[]);t.length>0&&k(t)},className:"hidden"}),(0,r.jsx)("span",{className:"inline-block px-4 py-2 bg-blue-600 text-white font-medium text-sm hover:bg-blue-700 transition-colors",children:"Select Files"})]})]}),e.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-center mb-4",children:[(0,r.jsx)("button",{className:"px-4 py-1.5 text-sm font-medium transition-colors ".concat("image"===v?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-100"),onClick:()=>f("image"),children:"Image"}),(0,r.jsx)("button",{className:"px-4 py-1.5 text-sm font-medium transition-colors ml-2 ".concat("video"===v?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-100"),onClick:()=>f("video"),children:"Video"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 mb-4 border border-gray-200",children:[(0,r.jsx)("h3",{className:"font-medium text-sm mb-3 text-gray-700",children:"Compression Settings"}),"image"===v?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsxs)("label",{className:"text-sm text-gray-600",children:["Quality: ",c,"%"]}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:c<65?"Smaller file":c>85?"Better quality":"Balanced"})]}),(0,r.jsx)("input",{type:"range",min:50,max:100,value:c,onChange:e=>d(Number(e.target.value)),className:"w-full h-2 bg-gray-200 appearance-none cursor-pointer accent-blue-600"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"lossless",checked:m,onChange:e=>x(e.target.checked),className:"w-4 h-4 accent-blue-600"}),(0,r.jsx)("label",{htmlFor:"lossless",className:"ml-2 text-xs text-gray-700",children:"Lossless compression (larger file, perfect quality)"})]})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Bitrate"}),(0,r.jsxs)("select",{className:"w-full p-1.5 text-sm border border-gray-300 bg-white",value:b.bitrate,onChange:e=>j({...b,bitrate:e.target.value}),children:[(0,r.jsx)("option",{value:"1M",children:"1 Mbps (Smaller file)"}),(0,r.jsx)("option",{value:"2M",children:"2 Mbps (Balanced)"}),(0,r.jsx)("option",{value:"4M",children:"4 Mbps (Better quality)"}),(0,r.jsx)("option",{value:"6M",children:"6 Mbps (High quality)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Resolution"}),(0,r.jsxs)("select",{className:"w-full p-1.5 text-sm border border-gray-300 bg-white",value:b.resolution,onChange:e=>j({...b,resolution:e.target.value}),children:[(0,r.jsx)("option",{value:"480",children:"480p"}),(0,r.jsx)("option",{value:"720",children:"720p"}),(0,r.jsx)("option",{value:"1080",children:"1080p"}),(0,r.jsx)("option",{value:"original",children:"Original (no resize)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Framerate"}),(0,r.jsxs)("select",{className:"w-full p-1.5 text-sm border border-gray-300 bg-white",value:b.framerate,onChange:e=>j({...b,framerate:e.target.value}),children:[(0,r.jsx)("option",{value:"24",children:"24 fps"}),(0,r.jsx)("option",{value:"30",children:"30 fps"}),(0,r.jsx)("option",{value:"60",children:"60 fps"}),(0,r.jsx)("option",{value:"original",children:"Original"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Codec"}),(0,r.jsx)("select",{className:"w-full p-1.5 text-sm border border-gray-300 bg-white",value:b.codec,onChange:e=>j({...b,codec:e.target.value}),children:(0,r.jsx)("option",{value:"h264",children:"H.264 (MP4, best compatibility)"})})]})]})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{onClick:M,disabled:h||0===e.length,className:"w-full py-3 font-medium text-sm text-white transition-colors ".concat(h?"bg-gray-500":"bg-blue-600 hover:bg-blue-700"),children:h?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Compressing..."]}):(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Compress & Convert"]})})}),o.length>0&&(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsxs)("button",{onClick:B,className:"flex items-center justify-center w-full py-3 bg-green-600 text-white text-sm hover:bg-green-700 transition-colors",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download All (ZIP)"]})})]})]})}),(0,r.jsx)("div",{className:"lg:w-2/3 border-t lg:border-t-0 lg:border-l border-gray-200",children:e.length>0?(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-medium mb-3 text-gray-700",children:["Files (",e.length,")"]}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:s.map((t,s)=>{let a=e[s],l=o.find(e=>e.originalName===a.name),i=u[a.name];return(0,r.jsxs)("div",{className:"group bg-white overflow-hidden border border-gray-200 hover:shadow transition-shadow",children:[(0,r.jsxs)("div",{className:"aspect-square bg-gray-100 relative",children:[(null==a?void 0:a.type.startsWith("image/"))?(0,r.jsx)("img",{src:t,alt:"preview",className:"w-full h-full object-contain"}):(0,r.jsx)("video",{src:t,className:"w-full h-full object-contain",controls:!0}),i&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-8 w-8 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),(0,r.jsxs)("div",{className:"p-2 text-xs",children:[(0,r.jsx)("div",{className:"truncate font-medium text-gray-700",children:null==a?void 0:a.name}),(0,r.jsx)("div",{className:"text-gray-500",children:L((null==a?void 0:a.size)||0)}),l&&(0,r.jsx)(r.Fragment,{children:l.error?(0,r.jsxs)("div",{className:"mt-2 bg-red-50 border border-red-200 p-2 rounded",children:[(0,r.jsxs)("div",{className:"text-red-600 text-xs font-medium flex items-start",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("span",{children:"Compression failed"})]}),(0,r.jsx)("div",{className:"text-red-500 text-xs mt-1 break-words",children:l.error.includes(":")?l.error.split(":").slice(1).join(":").trim():l.error||"Unknown error"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-1 w-full bg-gray-200 mt-2 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-green-500",style:{width:"".concat(100-Math.min((1-l.compressedSize/l.originalSize)*100,100),"%")}})}),(0,r.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,r.jsxs)("span",{className:"text-green-600 font-bold",children:[((1-l.compressedSize/l.originalSize)*100).toFixed(1),"%"]}),(0,r.jsx)("span",{children:L(l.compressedSize)})]}),(0,r.jsx)("a",{href:"".concat(C().replace("/api",""),"/uploads/").concat(l.outputName),download:l.outputName,onClick:e=>{e.preventDefault();let t=document.createElement("a");t.href="".concat(C().replace("/api",""),"/uploads/").concat(l.outputName),t.setAttribute("download",l.outputName),document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"block text-center text-white bg-blue-600 text-xs py-1 px-2 mt-1 hover:bg-blue-700",children:"Download"})]})})]})]},s)})}),o.length>0&&(0,r.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-3",children:(0,r.jsx)("h3",{className:"text-md font-medium text-gray-700",children:"Compression Results"})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:o.slice(0,4).map((e,t)=>{if(e.error){var s;return(0,r.jsxs)("div",{className:"bg-red-50 p-3 border border-red-200 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"truncate mr-2",children:[(0,r.jsx)("div",{className:"truncate text-xs font-medium text-red-700",children:e.originalName}),(0,r.jsxs)("div",{className:"text-xs text-red-600",children:["Compression failed: ",(null==(s=e.error.split(":")[1])?void 0:s.trim())||"Unknown error"]})]}),(0,r.jsx)("div",{className:"flex-shrink-0 text-xs bg-red-100 text-red-800 py-1 px-2 border border-red-200 rounded",children:"Failed"})]},t)}let a=(1-e.compressedSize/e.originalSize)*100,l=a>25;return(0,r.jsxs)("div",{className:"bg-gray-50 p-3 border border-gray-200 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"truncate mr-2",children:[(0,r.jsx)("div",{className:"truncate text-xs font-medium text-gray-700",children:e.outputName}),(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsxs)("span",{className:"font-bold ".concat(l?"text-green-600":"text-yellow-600"),children:[a.toFixed(1),"% smaller"]}),(0,r.jsxs)("span",{className:"text-gray-500 ml-1 text-xxs",children:["(",L(e.originalSize)," → ",L(e.compressedSize),")"]})]})]}),(0,r.jsxs)("a",{href:"".concat(C().replace("/api",""),"/uploads/").concat(e.outputName),download:e.outputName,onClick:t=>{t.preventDefault();let s=document.createElement("a");s.href="".concat(C().replace("/api",""),"/uploads/").concat(e.outputName),s.setAttribute("download",e.outputName),document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"flex-shrink-0 flex items-center text-xs bg-blue-600 text-white py-1 px-2 hover:bg-blue-700 transition-colors",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]},t)})}),o.length>4&&(0,r.jsxs)("div",{className:"text-center mt-3 text-sm text-gray-500",children:["+",o.length-4," more files compressed"]})]})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full p-6 text-center text-gray-400",children:(0,r.jsxs)("div",{className:"max-w-xs py-12",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("p",{className:"text-lg font-medium mb-2",children:"No files selected"}),(0,r.jsx)("p",{className:"text-sm",children:"Upload your images or videos to start compressing"})]})})})]})}),(0,r.jsxs)("div",{className:"text-center text-gray-500 text-sm mt-6 border-t border-gray-200 pt-6 w-full max-w-6xl",children:[(0,r.jsx)("p",{children:"Compress images and videos with optimized quality and file size"}),(0,r.jsx)("p",{className:"mt-1",children:"All processing happens locally - your files never leave your device"})]})]})}}},e=>{e.O(0,[125,441,255,358],()=>e(e.s=2799)),_N_E=e.O()}]);